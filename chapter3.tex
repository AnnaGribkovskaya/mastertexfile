\chapter{The Hatree-Fock theory}\label{ch:HF}
Here we present a brief overview of the Hatree-Fock (HF) theory. It is  well-known and defined way to study systems of large number of particles. Hartree-Fock method is the simplest and nevertheless rather efficient methods. Initially introduced by Hartree and then improved by Fock it is one of the most popular \textit{ab initio} methods in quantum chemistry.  It is  easy to implement, but has some disadvantages, for example it fail to provide high accuracy. However, more precise methods are often build on the HF results. This makes HF theory a good starting point for anyone who want to tackle a many-body problem. Methods that are using HF as an input are usually referred to as post-Hartree-Fock. Among them are Configuration Interaction (CI) and Coupled Cluster (CC). \\
The main idea of HF theory is to approximate unknown wave function with a single Slater Determinant constructed using a single-particle wave functions representing the occupied states in a system under consideration. 
\section{Introduction to HF}
Here we start with time independent Schr\"{o}dinger equation for the ground state:
\begin{equation}
\hat{H}\ket{\Phi_0}=E_0\ket{\Phi_0}
\end{equation}
In order to derive the HF equations we approximate the ground state wave function with a single SD:
\begin{equation}
\ket{\Phi_0}=\prod_{i=1}^{N}c_i^\dagger\ket{-}=\ket{\phi_0, \dots \phi_N}
\end{equation}
Here $\phi_0, \dots \phi_N$ are single-particle wave functions.

This method uses an approximation to the exact many-body wave function by a Slater determinant of $N$ orthonormal single-particle wave functions. In this case the approximate wave function of the system is given by:
\begin{equation}
\Phi(x_1, x_2,\dots ,x_N,\alpha,\beta,\dots, \sigma)=\frac{1}{\sqrt{N!}}
\left| \begin{array}{ccccc} \psi_{\alpha}(x_1)& \psi_{\alpha}(x_2)& \dots & \dots & \psi_{\alpha}(x_N)\\
\psi_{\beta}(x_1)&\psi_{\beta}(x_2)& \dots & \dots & \psi_{\beta}(x_N)\\  
\dots & \dots & \dots & \dots & \dots \\
\dots & \dots & \dots & \dots & \dots \\
\psi_{\sigma}(x_1)&\psi_{\sigma}(x_2)& \dots & \dots & \psi_{\sigma}(x_N)\end{array} \right|, \label{eq:HartreeFockDet}
\end{equation}
In this equation $\psi(x_i)$ stands for the single electron wave function, $x_i$ stand for the coordinates and spin values of a particle $i$ and $\alpha, \beta,â€¦,\sigma$ are quantum numbers needed to describe remaining quantum numbers.
However this expression can be simplified by introducing a new operator $\hat{A}$. This operator is given by 
\begin{equation}
\hat{A} = \frac{1}{N!}\sum_{p} (-)^p\hat{P},
\label{antiSymmetryOperator}
\end{equation}
here the sum goes over all possible permutations of two particles and $p$  stands for the number of permutations.\\
We also need to introduce Hartree-Fock wave function, which is given by product of all possible single-particle wave functions
\begin{equation}
\Phi_H(x_1,x_2,\dots,x_N,\alpha,\beta,\dots,\nu) =
\psi_{\alpha}(x_1)
\psi_{\beta}(x_2)\dots\psi_{\nu}(x_N).
\end{equation}
Using this notations Slater determinant can be rewritten as
\begin{equation}\label{determ}
\Phi(x_1,x_2,\dots,x_N,\alpha,\beta,\dots,\nu) = \frac{1}{\sqrt{N!}}\sum_{P} (-)^P\hat{P}\psi_{\alpha}(x_1)
\psi_{\beta}(x_2)\dots\psi_{\nu}(x_N)=\sqrt{N!}\hat{A}\Phi_H,
\end{equation}
Using a Slater determinant and assuming the Hamiltonian is given on form (\ref{eq:finalH}) we may obtain the functional $E[\Phi]$ for the energy. According to the variational principle
\begin{equation}
E[\Phi] \ge E_0
\end{equation}
here $E_0$ denote the exact ground state energy. 
There are two main strategies we may use now in order to obtain the ground state energy. In order to find the minimum of the energy functional we may either vary a Slater determinant, or we may expand the single-particle functions in some known basis and then vary the coefficients of expansions. In this project we use the second method. For those who want more detailed insight in the theory presented above in this chapter, please take a look at chapter 15 in \cite{mortenhjorth-jensenCOMPUTATIONALPHYSICS2015}.

\section{Derivation of a Hartree-Fock equations}
In order to derive the Hartree-Fock equations we need to chose an orthogonal basis to be used for expansion. As soon as we have H.O. potential that confine particles in the system it's reasonable to choose H.O. functions as a basis functions for the expansion as well. In this case we can be sure the functions are orthogonal by nature. 
\begin{equation}
\psi_p  = \sum_{\lambda} C_{p\lambda}\phi_{\lambda}. \label{eq:newbasis}
\end{equation}
here $\phi_{\lambda}$ is our new basis functions and $C_{p\lambda}$ represent expansion coefficients. This is a very important property for us, as soon as we will vary the coefficients in order to minimize energy. The sum in (\ref{eq:newbasis}) goes to infinity, however we will use a truncation to a certain value. \\
Using the definitions we introduce in part \ref{not} we may write the energy functional as
\begin{equation}
E[\Phi] 
= \sum_{\mu=1}^N \langle \mu | \hat{h}_0 | \mu \rangle +
\frac{1}{2}\sum_{{\mu}=1}^N\sum_{{\nu}=1}^N \langle \mu\nu|\hat{v}|\mu\nu\rangle_{\mathrm{AS}}.
\label{FunctionalEPhi}
\end{equation}
here $\mu$ and $\nu$ are basis functions we use in Slater determinant $\Phi$ defined in (\ref{determ}). After expansion in a new basis the functional for the energy turns into:
\begin{equation}
E[\Psi] 
= \sum_{i=1}^N \sum_{\alpha\beta}^Z C^*_{i\alpha}C_{i\beta}\langle \alpha | h | \beta \rangle +
\frac{1}{2}\sum_{ij=1}^N\sum_{{\alpha\beta\gamma\delta}}^Z C^*_{i\alpha}C^*_{j\beta}C_{i\gamma}C_{j\delta}\langle \alpha\beta|\hat{v}|\gamma\delta\rangle_{AS}. \label{FunctionalEPhi3}
\end{equation}
Here $\Psi$ is a new Slater determinant and $\alpha,\beta,\gamma,\delta$ correspond to new basis functions and $Z$ is energy cut-off representing the total possible number of states in a chosen basis. Coefficients $C$ are expansion coefficients from (\ref{eq:newbasis}). They form a unitary matrix that performs a transformation to a new basis and also preserve orthogonality of the basis functions. This allows us to use the Lagrange multiplier method to find the local minimum of the energy functional. We use orthogonality requirement as a constraint and set up a Lagrange functional, were all multipliers have to be in units of energy as soon as matrix $C$ contains only some numbers. Those energies are often called Hartree-Fock single particle energies. They are different from the single-particle energies corresponding to the basis functions because we chose the basis to be H.O. functions without any perturbations. However as it discussed below this new single-particle energies follow the same degeneracy pattern as a pure H.O. energies for the system (below the Fermi level). 
After applying the Lagrange multipliers method we obtain the following expression
\begin{equation}
\sum_{\beta}^Z C_{i\beta}\langle \alpha | h | \beta \rangle+
\sum_{j=1}^N\sum_{\beta\gamma\delta}^Z C^*_{j\beta}C_{j\delta}C_{i\gamma}\langle \alpha\beta|\hat{v}|\gamma\delta\rangle_{AS}=\epsilon_i^{HF}C_{i\alpha}.
\end{equation}
here $\epsilon_i^{HF}$ are new single-particle energies. Now we define Hartree-Fock matrix as
\begin{equation}
h_{\alpha\beta}^{HF}=\langle \alpha | h | \beta \rangle+
\sum_{j=1}^N\sum_{\gamma\delta} C^*_{j\gamma}C_{j\delta}\langle \alpha\gamma|\hat{v}|\beta\delta\rangle_{AS},
\end{equation}
once we obtain a matrix eigenvalue problem:
\begin{equation} \label{eig}
\hat{h}^{HF}C=\epsilon^{\mathrm{HF}}C.
\end{equation}
To simplify computations in our program we use so called density matrix. It is defined as
\begin{equation} \label{dens}
\rho_{\gamma\delta}=\sum_{i\le F}\langle\gamma|i\rangle\langle i|\delta\rangle = \sum_{i\le F}C_{i\gamma}C^*_{i\delta}.
\end{equation}
In this case Hamiltonian can be rewritten as 
\begin{equation}
\hat{h}_{\alpha\beta}^{HF}=\epsilon_{\alpha}\delta_{\alpha,\beta}+
\sum_{\gamma\delta} \rho_{\gamma\delta}\langle \alpha\gamma|\hat{v}|\beta\delta\rangle_{AS}.
\end{equation}
\section{Hartree-Fock basis}
After we have implemented the Hartree-Fock algorithm, we have compute the ground state energy and also have a coefficient matrix $C$. This coefficient allow us to perform a transformation to a Hartree-Fock basis. This can be done as follows:
\begin{equation}
\braket{ab|cd}=\sum_{ijkl}C_i^aC_j^bC_k^cC_l^d \braket{ij|kl}.
\end{equation}
Naive implementation of the formula above scales as $N^8$.
However one may mention that there are only one common index for each coefficient and the TBME so the transformation can be dome  by performing intermediate computations such as:
\begin{align}
\braket{aj|kl}=\sum_{i}C_i^a \braket{ij|kl},\\
\braket{ab|kl}=\sum_{j}C_j^b \braket{aj|kl},\\
\braket{ab|cl}=\sum_{k}C_k^c \braket{ab|kl},\\
\braket{ab|cd}=\sum_{l}C_l^d \braket{ab|cl}.
\end{align} 
Such transformations scale as $N^5$.